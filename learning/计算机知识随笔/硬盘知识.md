## 机械硬盘 (HDD)
组成：磁盘碟、机械手臂、磁盘读取头与主轴马达
扇区 (Sector) ：磁盘最小物理储存单位，分为
 512Bytes 跟 4KBytes 两种容量
磁道 (Track) ：磁盘上同一个同心圆的扇区组合成的圆
磁柱 (cylinder) ：所有磁盘碟上面同一个磁道组合成的,MBR下系统文件 (分区槽) 最小的单位


---
## 分区表
### MBR(Master Boot Record,主要开机记录)
MBR通常为磁盘的第一个扇区，放置有开机管理程序记录区和分区表，容量为 512Bytes ,包含有：
* 主要启动记录区 (Master Boot Record, MBR) :可以安装开机管理程序的地方，占用446Bytes
* 分区表 (partition table) :记录整颗硬盘分区的状态，占用 64Bytes

由于分区表仅有 64Bytes ，最多只能记录四组记录区，这四个分区的记录被称为主要
 (Primary) 或延伸 (Extended) 分区

* 延伸 (Extended) 分区：目的是使用额外的扇区 (Sectoe) 来记录分区信息，延伸分区本身不能被拿来格式化。因 Linux 限制，延伸分区只能有一个

* 逻辑 (Logical partition) 分区：是通过延伸(Extended)分区切出来的分区，用到的是延伸分区的磁柱

Linux装置名称(假设只有一颗硬盘)：
主要分区：/dev/sda1-4
逻辑分区：/dev/sda5-10

MBR缺点：
由于MBR每组分区表只有 16Bytes ，可记录信息相当有限，因此 MRB 会遇到以下问题
* 操作系统无法识别 2TB 以上磁盘
* 仅有一个分区区块，若损坏后无法救援
* 存放开机管理程序的区块仅有 446Bytes ，无法容纳较多程序代码

---

### GPT(Globally Unique Identifier Partition Table,全局唯一标识符分区表)
因扇区大小有多多种多样，为兼容所有的磁盘，在扇区 (sector) 的定义上，使用了所谓的逻辑区块地址 (Logical Block Address,LBA) 来处理。GPT将磁盘所有扇区以LBA (预设 512Bytes ) 来规划，第一个LBA称为LBA0。
*  LBA 0 (MBR相容扇区，也称为保护MBR)
与 MBR 模式相似的，这个兼容区块也分为两个部份，一个就是跟之前 446bytes 相似的区块，储存了第一阶段的开机管理程序！而在原本的分区表的纪录区内，这个兼容模式仅放入一个特殊标志的分区，用来表示此磁盘为 GPT 格式之意。同时也阻止不能识别GPT分区的磁盘工具试图对其进行格式化等操作。
*  LBA 1 (GPT表头记录)
纪录了分区表本身的位置与大小，同时纪录了备份用的 GPT 分区 (即最后 34 个 LBA 区块) 放置的位置，同时放置了分区表的检验机制码（CRC32），操作系统可以根据这个检验码来判断 GPT 是否正确。若有错误，还可以透过这个纪录区来取得备份的 GPT (磁盘最后的那个备份区块) 来恢复 GPT 的正常运作。
* LBA 2 ~ 33 (实际纪录分区信息处，即分区表)
分区表中的每个分区项由起始地址、结束地址、类型值、名字、属性标志、GUID值组成。分区表建立后，128位的GUID对系统来说是唯一的。
从 LBA2 扇区开始，每个 LBA 都可以纪录 4 笔分区纪录，所以在默认的情况下，总共可以有 4*32 = 128 笔分区纪录喔！因为每个 LBA 有 512Bytes，因此每笔纪录用到 128bytes 的空间，除了每笔纪录所需要的标识符与相关的纪录之外,GPT 在每笔纪录中分别提供了 64bits 来记载开始/结束的扇区号码。
* LBA 34 ~ -35 (GPT分区)
即硬盘实际组成部分。根据分区表的数量以及扇区 (Sector) 来划分
* LBA -34 ~ -1 (GPT备份区)
位于磁盘的尾部，包含GPT头和分区表的备份。它占用硬盘数据的末尾的33个扇区。其中最后一个扇区用来备份LBA1扇区的GPT头，其余的32个扇区用来备份LBA2～LBA33扇区的分区表
> 其中LBA1(GPT头)、LBA2 ~ 33(GPT分区表)、LBA34 ~ -35(GPT分区)、LBA-34 ~ -1(GPT备份区)统称为EFI部分的4个区域
详细参考<https://juejin.im/post/5b7ec7516fb9a019e6434224>

GPT优势：
突破 2TB 容量限制，并且对分区信息有备份

---
## 关于4096字节扇区

近年来，随着对硬盘容量的要求不断增加，为了提高数据记录密度，硬盘厂商往往采用增大扇区大小的方法，于是出现了扇区大小为4096字节的硬盘。我们将这样的扇区称之为“物理扇区”。但是这样的大扇区会有兼容性问题，有的系统或软件无法适应。为了解决这个问题，硬盘内部将物理扇区在逻辑上划分为多个扇区片段并将其作为普通的扇区（一般为512字节大小）报告给操作系统及应用软件。这样的扇区片段我们称之为“逻辑扇区”。实际读写时由硬盘内的程序（固件）负责在逻辑扇区与物理扇区之间进行转换，上层程序“感觉”不到物理扇区的存在。

逻辑扇区是硬盘可以接受读写指令的最小操作单元，是操作系统及应用程序可以访问的扇区，多数情况下其大小为512字节。我们通常所说的扇区一般就是指的逻辑扇区。物理扇区是硬盘底层硬件意义上的扇区，是实际执行读写操作的最小单元。是只能由硬盘直接访问的扇区，操作系统及应用程序一般无法直接访问物理扇区。一个物理扇区可以包含一个或多个逻辑扇区（比如多数硬盘的物理扇区包含了8个逻辑扇区）。当要读写某个逻辑扇区时，硬盘底层在实际操作时都会读写逻辑扇区所在的整个物理扇区。

这里说的“硬盘”及其“扇区”的概念，同样适用于存储卡、固态硬盘（SSD）。我们统称其为“磁盘”。它们在使用上的基本原理是一致的。其中固态硬盘在实现上更加复杂，它有“页”和“块”的概念，为了便于理解，我们可以简单的将其视同为逻辑扇区和物理扇区。另外固态硬盘在写入数据之前必须先执行擦除操作，不能直接写入到已存有数据的块，必须先擦除再写入。所以固态硬盘（SSD）对分区4K对齐的要求更高。如果没有对齐，额外的动作会增加更多，造成读写性能下降。

---
## 磁盘记录方式
磁盘记录方式有两种：
1. 旧式------非分区记录方式（即不同磁道扇区数相同）
每个磁道的扇区数相同，外圈磁道的扇区面积大，且外圈磁道转动速度快。又因为每个扇区存储数据量是相同的，外圈扇区的数据密度要比内圈扇区数据密度要低，对外圈磁道来说是一种资源浪费。

2. 新式-------分区记录方式（即不同磁道扇区数不同）
