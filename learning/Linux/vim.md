## vim 一个 Linux 下的纯文本编辑器
vim 是每个 Linux 发行版本都自带的纯文本编辑器，一本分为3种模式:
* 一般指令模式 (command mode)
以 vim 打开一个文件就直接进入一般指令模式了(这是默认的模式，也简称为一般模式)。在这个模式中，你可以使用上下左右按键来移动光标，你可以使用删除字符或删除整列来处理文件内容，也可以使用复制、贴上来处理你的文件数据。

* 编辑模式 (insert mode)
按下 i, I, o, O, a, A, r, R 等任何一个字母之后进入编辑模式。通常在 vim 编辑器中，按下这些按键时，在画面的左下方会出现 INSERT 或 REPLACE 的字样，此时才可以进行编辑。而如果要回到一般指令模式时，则必须要按下 Esc 这个按键即可退出编辑模式。

* 指令列命令模式 (command-line mode)
在一般模式当中，输入 : / ? 三个中的任何一个按钮，就可以将光标移动到最底下那一列。在这个模式当中，可以提供你读取、存盘、大量取代字符、离开 vim 、显示行号、搜寻资料等等的动作

## vim 指令详解
### 一般指令模式可用的指令
移动光标:
|指令|说明|
|-|-|
|<kbd>h</kbd> 或 <kbd>左箭头(←)</kbd>|光标向左移动一个字符|
|<kbd>j</kbd> 或 <kbd>下箭头(↓)</kbd>|光标向下移动一个字符|
|<kbd>k</kbd> 或 <kbd>上箭头(↑)</kbd>|光标向上移动一个字符|
|<kbd>l</kbd> 或 <kbd>右箭头(→)</kbd>|光标向右移动一个字符|
|30j 或 30↓|向下移动 30 列|
|<kbd>Ctrl</kbd> + <kbd>f</kbd>|屏幕向下移动一页，相当于<kbd>Page Down</kbd>按键(常用)|
|<kbd>Ctrl</kbd> + <kbd>b</kbd>|屏幕向上移动一页，相当于<kbd>Page Up</kbd>按键(常用)|
|<kbd>Ctrl</kbd> + <kbd>d</kbd>|屏幕向下移动半页|
|<kbd>Ctrl</kbd> + <kbd>u</kbd>|屏幕向上移动半页|
|<kbd>+</kbd>|光标移动到非空格符的下一行|
|<kbd>-</kbd>|光标移动到非空格符的上一行|
|n<kbd>space</kbd>| n 表示数字，例如20 。按下数字后再按空格键，光标会向右移动这一行的 n 个字符。例如 20<kbd>space</kbd> 则光标会向后面移动 20 个字符距离|
|0 或 <kbd>Home</kbd>|数字0：移动到这一行的最前面字符处 (常用)|
|$ 或 <kbd>[End]</kbd>|移动到这一行的最后面字符处(常用)|
|<kbd>H</kbd>|光标移动到这个屏幕的最上方那一行的第一个字符|
|<kbd>M</kbd>|光标移动到这个屏幕的中央那一行的第一个字符|
|<kbd>L</kbd>|光标移动到这个屏幕的最下方那一行的第一个字符|
|<kbd>G</kbd>|移动到这个文件的最后一行(常用)|
|n<kbd>G</kbd>|n 为数字。移动到这个文件的第 n 行。例如 20<kbd>G</kbd> 则会移动到这个文件的第 20 行(可配合 :set nu)|
|<kbd>gg</kbd>|移动到这个文件的第一行，相当于 1G(常用)|
|n<kbd>Enter</kbd>|n 为数字。光标向下移动 n 行(常用)|

搜寻与取代:
|指令|说明|
|-|-|
|/word|向光标之下寻找一个名称为 word 的字符串。例如要在文件内搜寻 test 这个字符串，就输入 /test 即可(常用)|
|?word|向光标之上寻找一个字符串名称为 word 的字符串|
|<kbd>n</kbd>|代表重复前一个搜寻的动作。举例来说， 如刚刚执行的 /test 去向下搜寻 test 这个字符串，则按下 n 后，会向下继续搜寻下一个名称为test 的字符串。如果是执行 ?test 的话，那么按下 n 则会向上继续搜寻名称为 test 的字符串|
|<kbd>N</kbd>|与 <kbd>n</kbd> 刚好相反，为反向进行前一个搜寻动作。 例如 /test 后，按下 N 则表示向上搜寻 test |
|:n1,n2s/word1/word2/g|n1 与 n2 为数字。在第 n1 与 n2 行之间寻找 word1 这个字符串，并将该字符串取代为 word2 。如在 100 到 200 列之间搜寻 test 并取代为 TEST 则：`:100,200s/test/TEST/g`(常用)|
|:1,$s/word1/word2/g|从第一行到最后一行寻找 word1 字符串，并将该字符串取代为 word2(常用)|
|:%s/word1/word2/gi|同`:1,$s/word1/word2/g`一样，都是整个文件替换，其中 g 和 c 为可选项，g 为全局替换，i 为忽略大小写。如果不加上可选项，那个只会替换每行匹配的第一个字符|
|:1,$s/word1/word2/gc|从第一行到最后一行寻找 word1 字符串，并将该字符串取代为 word2 ！且在取代前显示提示字符给用户确认 (confirm) 是否需要取代(常用)|


删除、复制与粘贴:
|指令|说明|
|-|-|
|<kbd>x</kbd>, <kbd>X</kbd>|在一行字当中，x 为向后删除一个字符 (相当于<kbd>del</kbd>按键)， X 为向前删除一个字符(相当于<kbd>backspace</kbd>亦即是退格键)(常用)|
|n<kbd>x</kbd>|n 为数字，连续向后删除 n 个字符。如连续删除 10 个字符: 10<kbd>x</kbd> |
|<kbd>dd</kbd>|删除游标所在的那一整行(常用)|
|n<kbd>dd</kbd>|n 为数字。删除光标所在的向下 n 行。如 20<kbd>dd</kbd> 则是删除 20 行(常用)|
|<kbd>d</kbd>1<kbd>G</kbd>|删除光标所在到第一行的所有数据|
|<kbd>dG</kbd>|删除光标所在到最后一行的所有数据|
|<kbd>d$</kbd>|删除游标所在处，到该行的最后一个字符|
|<kbd>d</kbd>0|数字的 0 ，删除游标所在处，到该行的最前面一个字符|
|<kbd>yy</kbd>|复制游标所在的那一行(常用)|
|n<kbd>yy</kbd>|n 为数字。复制光标所在的向下 n 行，例如 20<kbd>yy</kbd> 则是复制 20 行(常用)|
|<kbd>y</kbd>1<kbd>G</kbd>|复制光标所在行到第一行的所有数据|
|<kbd>yG</kbd>|复制光标所在列到最后一行的所有数据|
|<kbd>y0</kbd>|复制光标所在的那个字符到该行行首的所有数据|
|<kbd>y$</kbd>|复制光标所在的那个字符到该行行尾的所有数据|
|<kbd>p</kbd>, <kbd>P</kbd>|<kbd>p</kbd> 为将已复制的数据在光标下一行贴上，<kbd>P</kbd> 则为贴在游标上一行(常用)
|<kbd>J</kbd>|将光标所在行与下一行的数据结合成同一行|
|<kbd>c</kbd>|重复删除多个数据，例如向下删除 10 行: `10cj`
|<kbd>u</kbd>|复原前一个动作。(常用)|
|<kbd>Ctrl</kbd> + <kbd>r</kbd>|重做上一个动作(常用)|
|<kbd>.</kbd>|这就是小数点意思是重复前一个动作的意思。 如果你想要重复删除、重复贴上等等动作，按下小数点<kbd>.</kbd>就好了(常用)|

### 编辑模式可用的指令
进入插入或取代的编辑模式:
|指令|说明|
|-|-|
|<kbd>i</kbd>，<kbd>I</kbd>|进入插入模式(Insert mode)：<kbd>i</kbd> 为从目前光标所在处插入，<kbd>I</kbd> 为在目前所在列的第一个非空格符处开始插入(常用)|
|<kbd>a</kbd>，<kbd>A</kbd>|进入插入模式(Insert mode)：<kbd>a</kbd> 为从目前光标所在的下一个字符处开始插入， <kbd>A</kbd> 为从光标所在列的最后一个字符处开始插入(常用)|
|<kbd>o</kbd>，<kbd>O</kbd>|进入插入模式(Insert mode)：英文字母 o 的大小写。<kbd>o</kbd> 为在目前光标所在的下一行处插入新的一行；<kbd>O</kbd> 为在目前光标所在处的上一行插入新的一行(常用)|
|<kbd>r</kbd>，<kbd>R</kbd>|进入取代模式(Replace mode)：<kbd>r</kbd> 只会取代光标所在的那一个字符一次；<kbd>R</kbd> 会一直取代光标所在的文字，直到按下 ESC为止(常用)|
|<kbd>Esc</kbd>|退出编辑模式，回到一般指令模式中(常用)|

### 指令列模式可用的指令
#### 储存、离开等指令:
|指令|说明|
|-|-|
|:w|将编辑的数据写入硬盘文件中(常用)|
|:w!|若文件属性为只读时，强制写入该文件。最终能否写入是跟你对该文件的文件权限有关|
|:q|离开 vi (常用)|
|:q!|若曾修改过文件，又不想储存，可使用 q! 强制离开不储存文件。惊叹号 (!) 在 vim 当中具有强制的意思|
|:wq|储存后离开，若为 :wq! 则为强制储存后离开(常用)|
|ZZ|这是大写的 Z 喔！若文件没有更动，则不储存离开，若文件已经被更动过，则储存后离开|
|:w [filename]|将编辑的数据储存成另一个文件(类似另存新档)|
|:r [filename]|在编辑的数据中，读入另一个文件的数据。亦即将 filename 这个文件内容加到游标所在列后面|
|:n1,n2 w [filename]|将 n1 到 n2 的内容储存成 filename 这个文件|
|:! command|暂时离开 vim 到指令列模式下执行 command 的显示结果。例如 `:! ls /home` 即可在 vim 当中察看 /home 底下以 ls 输出的文件信息|

#### vim 环境设置命令:
.viminfo: 在每个家目录下的文件，用于记录 vim 曾经做过的行为
.vimrc(/etc/vimrc): vim 环境设置文件，可以把下边的设置直接写入这个文件，那么下次打开 vim 时将会按照以下设置打开
|指令|说明|
|-|-|
|:set nu|显示行号，设定之后, 会在每一行的前缀显示该行的行号|
|:set nonu|与 set nu 相反, 为取消行号|
|:set hlsearch|high light search(高亮度搜寻)，默认值|
|:set nohlsearch|vimrc 中取消高亮度搜寻|
|noh|vim 中直接取消高亮|
|:set autoindent|设置自动缩进|
|:set noautoindent|不设置自动缩进|
|:set backup|是否自动储存备份档，如果设置了 backup, 那么当你改动任何文件时, 源文件会被另存为一个名为
 filename~ 的文件, 默认值为 nobackup|
|:set ruler|是否显示右下角状态说明栏|
|:set showmode|是否显示左下角 --INSERT-- 状态栏|
|:set backspace=(012)|通常情况下可以在编辑模式中使用退格键<kbd>backspace</kbd>删除任意字符。但是某些发行版本不允许这样操作。那么就可以通过 backspace 设置。0和1指只能删除刚刚输入的字符，不能删除之前已存在的字符；2为可以删除任意字符|
|:set all|显示目前所有环境参数设定值|
|:set|显示所有非默认值设定参数，即|


#### vim 额外命令:
区块选择
|指令|说明|
|-|-|
|<kbd>v</kbd>|字符选择，将光标经过的地方泛白选择|
|<kbd>V</kbd>|列选择，将光标经过的列泛白选择|
|<kbd>ctrl</kbd> + <kbd>v</kbd>|区块选择，可用长方块选择资料(不能在 ssh 下操作)|
|<kbd>y</kbd>|将泛白的地方复制|
|<kbd>d</kbd>|将泛白的地方删除|
|<kbd>p</kbd>|粘贴刚刚复制的泛白区块|

多文件编辑

可以使用 `vim file1 file2` 同时打开编辑两个文件，然后使用下边的命令对两个文件进行切换
|指令|说明|
|-|-|
|:n|编辑下一个文件|
|:N|编辑上一个文件|
|:files|显示目前通过 vim 打开的文件|

多窗口功能

|指令|说明|
|-|-|
|:sp [filename]|开启一个新的窗口，如果加上了 filename，表示新窗口开启了一个新文件，否则两个窗口显示同一个文件内容|
|<kbd>ctrl</kbd> + <kbd>w</kbd> + <kbd>j</kbd>/<kbd>↓</kbd>|光标切换到下方窗口|
|<kbd>ctrl</kbd> + <kbd>w</kbd> + <kbd>k</kbd>/<kbd>↑</kbd>|光标切换到上方窗口|
|<kbd>ctrl</kbd> + <kbd>w</kbd> + <kbd>q</kbd>|退出窗口|

字符补全

|指令|说明|
|-|-|
|<kbd>ctrl</kbd> + <kbd>x</kbd> --> <kbd>ctrl</kbd> + <kbd>n</kbd>|透过目前正在编辑的这个文件的内容文字作为关键词，予以补齐|
|<kbd>ctrl</kbd> + <kbd>x</kbd> --> <kbd>ctrl</kbd> + <kbd>f</kbd>|以当前目录内的文件名作为关键词，予以补齐|
|<kbd>ctrl</kbd> + <kbd>x</kbd> --> <kbd>ctrl</kbd> + <kbd>o</kbd>|以扩展名作为语法补充，以 vim 内建的关键词，予以补齐|

#### vim 命令详细图解:
![19105004_eXTo.jpg](https://i.loli.net/2020/11/08/9soZc68wFCpMJDy.jpg)

### vim 救援模式
vim 打开文件时，都会在当前工作目录建立一个 .filename.swap 的临时文件，如果文件被不正常关闭或打开该文件时，有其他人或程序正在编辑这个文件，就会出现打开该临时文件，如图所示:
![捕获4.PNG](https://i.loli.net/2020/11/08/jDuFp5TWEmR18AK.png)

该临时文件提供了六个按钮:
* [O]pen Read-Only：打开此文件成为只读档， 可以用在你只是想要查阅该文件内容并不想要进行编辑行为时
* (E)dit anyway：还是用正常的方式打开你要编辑的那个文件，并不会载入临时文件的内容。不过很容易出现两个使用者互相改变对方的文件等问题
* \(R\)ecover：加载临时文件的内容，用在你要救回之前未储存的工作。不过当你救回来并且储存离开 vim后，还是要手动自行删除临时文件
* (D)elete it：当确定那个临时文件是无用的，那么开启文件前会先将这个临时文件删除
* (Q)uit：按下 q 就离开 vim ，不会进行任何动作回到命令提示字符。
* (A)bort：忽略这个编辑行为，与 quit 非常类似

